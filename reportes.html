<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="shortcut icon" href="img/BCO.e6d7dd8f-4e61-441c-9e1b-46fb37f973a5.png" type="image/x-icon">
  <title>Observatorio de Fen√≥menos Naturales</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
</head>
<body>
  <!-- Header corporativo -->
  <header>
<div class="logo">
  <a href="index2.html" style="display:flex; align-items:center; text-decoration:none; color:inherit;">
    <img src="img/BCO.e6d7dd8f-4e61-441c-9e1b-46fb37f973a5.png" alt="Logo Observatorio" />
    <h1>Observatorio.</h1>
  </a>
</div>
    <div id="auth-buttons">
      <a href="login.html"><button id="login-btn">Iniciar sesi√≥n</button></a>
      <a href="register.html"><button id="register-btn">Registrarse</button></a>
      <span id="user-info" style="display: none;">
        <img id="user-pic" src="" alt="Perfil" width="32" height="32" style="border-radius: 50%;" />
        <span id="username"></span>
        <button id="logout-btn">Cerrar sesi√≥n</button>
      </span>
    </div>
    <!-- Bot√≥n Dark Mode -->
    <button id="toggle-theme"><img src="img/dark-mode-svgrepo-com.svg" alt="" srcset=""></button>
  </header>

  <main>
    <!-- Formulario para la creacion de reportes de los que entren -->
    <section id="form-section">
      <h2>üì¢ Reporta un fen√≥meno</h2>
      <div class="form-layout">
        <aside class="form-sidebar">
          <h3>Tipos de fen√≥meno</h3>
<ul class="tipo-lista" role="radiogroup" aria-label="Tipos de fen√≥meno">
  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="sismo" />
      <span class="icono" aria-hidden="true">
        <!-- Sismo (fallas/ondas) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M3 12h3l2-4 3 8 2-5 2 3h4" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Sismo</span>
    </label>
  </li>
  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="tormenta" />
      <span class="icono" aria-hidden="true">
        <!-- Tormenta (rayo y nube) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M7 18h10a4 4 0 0 0 0-8h-.5A5.5 5.5 0 1 0 7 10" fill="none" stroke="currentColor" stroke-width="2"/>
          <path d="M13 12l-2 4h3l-2 4" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Tormenta</span>
    </label>
  </li>
  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="incendio" />
      <span class="icono" aria-hidden="true">
        <!-- Incendio (llama) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M12 3s3 3 3 6-2 4-2 6 1 4-3 4-5-3-5-6 2-5 5-6l2-4z" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Incendio</span>
    </label>
  </li>
  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="otros" />
      <span class="icono" aria-hidden="true">
        <!-- Otros (estrella) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M12 3l2.4 6.9H21l-5.4 4 2.1 7-5.7-3.9-5.7 3.9 2.1-7L3 9.9h6.6z" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Otro</span>
    </label>
  </li>
</ul>
<p>Selecciona el tipo para clasificar tu reporte y activar el archivo simb√≥lico.</p>
        </aside>
        <form id="report-form">
          <input type="text" id="title" placeholder="T√≠tulo del fen√≥meno" required />
          <textarea id="description" placeholder="Descripci√≥n detallada" required></textarea>
          <input type="text" id="location" placeholder="Ubicaci√≥n (ciudad, regi√≥n)" required />
          <button type="submit">Enviar reporte</button>
        </form>
      </div>
    </section>

    <!-- Reportes recientes -->
    <section id="map-section">
      <h2>Reportes Recientes</h2>
      <div class="archivo-layout">
        <div id="map"></div>
        <aside class="archivo-sidebar">
          <h3>Filtros por tipo</h3>
<ul class="tipo-lista" role="radiogroup" aria-label="Tipos de fen√≥meno">
  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="sismo" />
      <span class="icono" aria-hidden="true">
        <!-- Sismo (fallas/ondas) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M3 12h3l2-4 3 8 2-5 2 3h4" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Sismo</span>
    </label>
  </li>

  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="tormenta" />
      <span class="icono" aria-hidden="true">
        <!-- Tormenta (rayo y nube) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M7 18h10a4 4 0 0 0 0-8h-.5A5.5 5.5 0 1 0 7 10" fill="none" stroke="currentColor" stroke-width="2"/>
          <path d="M13 12l-2 4h3l-2 4" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Tormenta</span>
    </label>
  </li>

  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="incendio" />
      <span class="icono" aria-hidden="true">
        <!-- Incendio (llama) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M12 3s3 3 3 6-2 4-2 6 1 4-3 4-5-3-5-6 2-5 5-6l2-4z" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Incendio</span>
    </label>
  </li>
  <li>
    <label class="tipo-item">
      <input type="radio" name="tipo" value="otros" />
      <span class="icono" aria-hidden="true">
        <!-- Otros (estrella) -->
        <svg viewBox="0 0 24 24" width="28" height="28">
          <path d="M12 3l2.4 6.9H21l-5.4 4 2.1 7-5.7-3.9-5.7 3.9 2.1-7L3 9.9h6.6z" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
      </span>
      <span class="tipo-texto">Otro</span>
    </label>
  </li>
</ul>
<div class="archivo-stats">
  <h4>üìà Estad√≠sticas</h4>
  <p>Total reportes: <span id="total-reportes"></span></p>
  <canvas id="statsChart" width="700" height="160"></canvas>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  async function cargarStats() {
    try{
      const res = await fetch("http://localhost:3000/api/stats");
      const stats = await fetch("js/reports.js");
      const data = await res.json();
      console.log("Datos recibidos:", data);
      document.getElementById("total-reportes").textContent = data.total;
      const ctx = document.getElementById("statsChart").getContext("2d");
      new Chart(ctx, {
        type: "bar",
        data: {
          labels: Object.keys(data.porTipo),
          datasets: [{
            label: "Reportes por tipo",
            data: Object.values(data.porTipo),
            backgroundColor: ["#2563eb", "#3b82f6", "#f59e0b", "#10b981"]
          }]
        }
      });
    } catch (err) {
      console.error("‚ùå Error cargando stats:", err);
    }
  }
  // Ejecutar al cargar la p√°gina
  cargarStats();
</script>
    </section>
  </main>
  <!-- Footer corporativo ----------------->
 <footer class="site-footer">
  <div class="footer-container">
    <div class="footer-brand">
      <img src="img/BCO.e6d7dd8f-4e61-441c-9e1b-46fb37f973a5.png" alt="Logo Observatorio" class="footer-logo" />
      <p>Archivo vivo de fen√≥menos naturales y presencia digital.</p>
    </div>

    <div class="footer-section">
      <h4>Observatorio</h4>
      <ul>
        <li><a href="about.html">Qui√©nes somos</a></li>
        <li><a href="reportes.html">Reportes</a></li>
        <li><a href="mapa.html">Mapa</a></li>
        <li><a href="archivo.html">Archivo</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h4>Recursos</h4>
      <ul>
        <li><a href="api.html">API</a></li>
        <li><a href="dashboard.html">Panel</a></li>
        <li><a href="tutoriales.html">Tutoriales</a></li>
        <li><a href="faq.html">FAQ</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h4>Contacto</h4>
      <ul>
        <li><a href="contacto.html">Escr√≠benos</a></li>
        <li><a href="prensa.html">Prensa</a></li>
        <li><a href="licencias.html">Licencias</a></li>
      </ul>
      <div class="social-icons">
        <a href="#"><img src="img/facebook-1-svgrepo-com.svg" alt="Facebook" /></a>
        <a href="#"><img src="img/instagram-1-svgrepo-com.svg" alt="Instagram" /></a>
      </div>
    </div>
  </div>

  <div class="footer-bottom">
    <p>¬© 2025 Observatorio de Fen√≥menos Naturales. Todos los derechos reservados.</p>
    <ul class="footer-legal">
      <li><a href="privacidad.html">Privacidad</a></li>
      <li><a href="terminos.html">T√©rminos</a></li>
      <li><a href="cookies.html">Cookies</a></li>
    </ul>
  </div>
</footer>
  <!-- Scripts -->
  <script>
    // Env√≠o de reportes
    document.getElementById("report-form").addEventListener("submit", function (e) {
      e.preventDefault();

      const title = document.getElementById("title").value.trim();
      const description = document.getElementById("description").value.trim();
      const location = document.getElementById("location").value.trim();
      
      const newReport = {
        title,
        description,
        location,
        date: new Date().toLocaleString()
      };

      fetch("http://localhost:3000/api/reportes", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(newReport)
      })
      .then(res => res.json())
      .then(data => {
        console.log("‚úÖ Reporte guardado en archivo:", data);
      })
      .catch(err => {
        console.error("‚ùå Error al guardar el reporte:", err);
      });
    });

    // Dark Mode toggle

  </script>


<script>
  const toggleBtn = document.getElementById("toggle-theme");

  const sunSVG = `
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="orange" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="5"/>
    </svg>
  `;



  toggleBtn.addEventListener("click", () => {
    document.body.classList.toggle("dark-mode");
    toggleBtn.innerHTML = document.body.classList.contains("dark-mode") ? sunSVG : moonSVG;
  });
</script>

  <script src="components/map.js"></script>
  <script src="components/form.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</body>
<script src="components/stats.js"></script>
</html>
